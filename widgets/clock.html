<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>CLock Widget - Squarehad Labs</title>
    <style>
        body {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow-x: hidden;
            overflow-y: hidden;
        }

        #clock {
            font-size: 150px;
            text-align: center;
            font-family: 'Karla', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;

        }

        #time {
            font-weight: bold;
            display: inline-block;
            margin-top: 0;
            padding-top: 0;
        }

        #am-pm {
            font-size: 30px;
            display: inline-block;

        }

        #switch-btn,
        #settings-btn {
            font-family: Karla;
            background-color: transparent;
            border: none;
            position: fixed;
            bottom: 20px;
        }

        #settings-btn {
            margin-left: 40px;
        }

        #switch-btn:hover,
        #settings-btn:hover {
            cursor: pointer;
            transform: scale(1.2);
        }

        #settings-modal {
            font-family: Rubik;
            display: none;
            align-items: center;
            justify-content: center;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            width: 300px;
            font-family: Rubik;
            color: black;
            align-items: center;
            justify-content: center;
            background-color: #f7f6f3;
            padding: 30px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .setting-option {
            text-align: center;
            align-item: center;
            font-family: Rubik;
            margin-bottom: 10px;
        }

        #setting-wrapper {
            text-align: center;
            flex-direction: column;
            display: flex;
            align-item: center;
        }

        .close-btn {
            color: #000;
            float: right;
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
        }

        #save-btn {
            margin-top: 10px;
            width: 60%;
            font-family: Rubik;
            background-color: black;
            color: #fff;
            border: none;
            border-radius: 100px;
            padding: 10px 20px;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;

        }


        #save-btn:hover {
            background-color: grey;
            color: white;

        }


        select {
            appearance: none;
            background-color: transparent;
            border: none;
            padding: 0 1em 0 0;
            margin: 10px;
            width: 60%;
            font-family: inherit;
            font-size: inherit;
            cursor: inherit;
            line-height: inherit;
        }

        /* Media Queries for Different Screen Sizes */

        /* For screens with width less than or equal to 768px */
        @media screen and (max-width: 768px) {
            #clock {
                font-size: 100px;
            }

            #am-pm {
                font-size: 10px;
            }
        }

        /* For screens with width less than or equal to 576px */
        @media screen and (max-width: 576px) {
            #clock {
                font-size: 80px;
            }

            #am-pm {
                font-size: 10px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Karla:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>
    <div id="clock">
        <div id="time-wrapper">
            <h2 id="title" style="margin: 0; padding: 0; opacity: 0.60; font-size: 3rem;">meow</h4>
                <div id="time"></div>
                <div id="am-pm"></div>
                <button id="switch-btn">12/24</button>
        </div>
    </div>

    <script>
        const clock = document.getElementById("clock");
        const title = document.getElementById("title");
        const time = document.getElementById("time");
        const amPm = document.getElementById("am-pm");
        const switchBtn = document.getElementById("switch-btn");
        const settingsModal = document.getElementById("settings-modal");
        const closeModalBtn = document.querySelector(".close-btn");
        const saveBtn = document.getElementById("save-btn");
        const backgroundColorSelect = document.getElementById("background-color");
        const fontColorSelect = document.getElementById("font-color");

        const urlParams = new URLSearchParams(window.location.search);
        const label = urlParams.get("label")
        const timeZone = urlParams.get("timezone")

        title.innerText = label ? label : timeZone;


        // Default values
        let requiredBackgroundColor = urlParams.get("bc") ?? "LM-Default";
        let requiredFontColor = urlParams.get("fc") ?? "LM-Default";

        let is24Hour = urlParams.get("24h") === "true";
        let backgroundColor = requiredBackgroundColor.startsWith('#') ? requiredBackgroundColor : getBackgroundColor(requiredBackgroundColor);
        let fontColor = requiredFontColor.startsWith('#') ? requiredFontColor : getFontColor(requiredFontColor);

        console.log(requiredBackgroundColor, backgroundColor)

        document.addEventListener("DOMContentLoaded", function () {
            updateTime();
        });


        function getFontColor(colorName) {
            // Light mode colors
            switch (colorName) {
                case "LM-Default":
                    return "#37352F";
                case "LM-Grey":
                    return "#787774";
                case "LM-Brown":
                    return "#9F6B53";
                case "LM-Orange":
                    return "#D9730D";
                case "LM-Yellow":
                    return "#CB912F";
                case "LM-Green":
                    return "#448361";
                case "LM-Blue":
                    return "#337EA9";
                case "LM-Purple":
                    return "#9065B0";
                case "LM-Pink":
                    return "#C14C8A";
                case "LM-Red":
                    return "#D44C47";
            }

            // Dark mode colors
            switch (colorName) {
                case "DM-Grey":
                    return "#979A9B";
                case "DM-White":
                    return "#D4D4D4";
                case "DM-Brown":
                    return "#937264";
                case "DM-Orange":
                    return "#FFA344";
                case "DM-Yellow":
                    return "#FFDC49";
                case "DM-Green":
                    return "#4DAB9A";
                case "DM-Blue":
                    return "#529CCA";
                case "DM-Purple":
                    return "#9A6DD7";
                case "DM-Pink":
                    return "#E255A1";
                case "DM-Red":
                    return "#FF7369";
            }

            return "#37352F";
        }

        function getBackgroundColor(colorName) {
            // Light mode colors
            switch (colorName) {
                case "LM-Default":
                    return "#FFFFFF";
                case "LM-Off-White":
                    return "#F7F6F3";
                case "LM-Grey":
                    return "#F1F1EF";
                case "LM-Brown":
                    return "#F4EEEE";
                case "LM-Orange":
                    return "#FAEBDD";
                case "LM-Yellow":
                    return "#FBF3DB";
                case "LM-Green":
                    return "#EDF3EC";
                case "LM-Blue":
                    return "#E7F3F8";
                case "LM-Purple":
                    return "#F6F3F9";
                case "LM-Pink":
                    return "#FAF1F5";
                case "LM-Red":
                    return "#FDEBEC";
            }

            // Dark mode colors
            switch (colorName) {
                case "DM-Default":
                    return "#191919";
                case "DM-Hover":
                    return "#262626";
                case "DM-Sidebar":
                    return "#202020";
                case "DM-Brown":
                    return "#434040";
                case "DM-Orange":
                    return "#594A3A";
                case "DM-Yellow":
                    return "#59563B";
                case "DM-Green":
                    return "#354C4B";
                case "DM-Blue":
                    return "#364954";
                case "DM-Purple":
                    return "#443F57";
                case "DM-Pink":
                    return "#533B4C";
                case "DM-Red":
                    return "#594141";
            }

            return "#FFFFFF";
        }

        function getCityHour(timeZone) {
            const hour = new Intl.DateTimeFormat('es-MX', {
                timeZone,
                hour: '2-digit',
                minute: '2-digit',
                hour12: is24Hour
            }).format(new Date());

            return hour.replace(" a.m.", "").replace(" p.m.", "");
        }

        function updateTime() {
            let date = new Date();
            let hours = date.getHours();
            let minutes = date.getMinutes();

            time.innerText = getCityHour(timeZone)
            if (!is24Hour) {
                let amPmValue = hours >= 12 ? "PM" : "AM";
                hours = hours % 12 || 12;
                amPm.innerText = amPmValue;
            } else {
                amPm.innerText = "";
            }

            clock.style.color = fontColor;
            document.body.style.color = fontColor;
            document.body.style.backgroundColor = backgroundColor;
            switchBtn.style.color = fontColor;
        }

        function openSettingsModal() {
            settingsModal.style.display = "flex";
        }

        function closeSettingsModal() {
            settingsModal.style.display = "none";
        }

        switchBtn.addEventListener("click", () => {
            is24Hour = !is24Hour;
            switchBtn.innerText = is24Hour ? "24" : "12";
            updateTime();
        });

        setInterval(updateTime, 1000);
    </script>
</body>

</html>
